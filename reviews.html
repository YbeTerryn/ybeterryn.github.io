<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <title>Reviews - Pieter Paul Tybbe</title> 
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  
<header id="main-header">
  <nav id="main-nav"></nav>
</header>

<header class="sesjat-header">
  <p class="glyph">ìÇÄ</p>
  <h1>Pieter Paul Tybbe</h1>
  <p class="subtitle">Reviews: Scherp, aandachtig en slechts licht bevooroordeeld</p>
</header>

<div class="filter-section">
  <div class="search-wrapper">
    <span class="search-icon">üîç</span>
    <input type="text" id="searchInput" class="search-bar" placeholder="reviews filteren...">
  </div>
</div>

<main class="grid" id="main-container"></main>

<script src="data/stories.js"></script>

<script>
window.addEventListener('DOMContentLoaded', () => {
    const container = document.getElementById("main-container");
    const searchInput = document.getElementById("searchInput");

    let currentList = [];
    const pageTitle = document.title;
    
    if (pageTitle.includes("Offers")) {
        currentList = stories;
    } else if (pageTitle.includes("Archief")) {
        currentList = archiveStories;
    } else if (pageTitle.includes("Reviews")) {
        currentList = reviewStories;
    }

    function render(filter = "") {
        container.innerHTML = "";
        const searchTerm = filter.toLowerCase();

        const filtered = currentList.filter(item => {
            return item.title.toLowerCase().includes(searchTerm) || 
                   (item.year && item.year.toString().includes(searchTerm)) ||
                   (item.director && item.director.toLowerCase().includes(searchTerm)) ||
                   (item.date && item.date.toLowerCase().includes(searchTerm));
        });

        filtered.slice().reverse().forEach(item => {
            const card = document.createElement("article");
            card.className = "card";
            
            // --- NIEUW: LOGICA VOOR ICOONTJES ---
            let iconHtml = "";
            if (item.platform === "letterboxd") {
                iconHtml = '<i class="fab fa-letterboxd"></i> ';
            } else if (item.platform === "storygraph") {
                iconHtml = '<i class="fas fa-book-open"></i> ';
            }
            
            const isExternal = !!item.link;
            const link = isExternal ? item.link : `story.html?id=${item.id}`;
            const target = isExternal ? 'target="_blank" rel="noopener noreferrer"' : '';
            const buttonClass = isExternal ? 'read-link letterboxd-link' : 'read-link';
            
            // Voeg iconHtml toe aan de knoptekst
            const buttonText = isExternal ? `${iconHtml}LEES` : 'LEES';

            card.innerHTML = `
                <div class="card-content">
                    <img src="${item.image}" alt="${item.title}" class="card-image">
                    <div class="card-text">
                        <h2>${item.title}</h2>
                        <p class="meta">${item.year || item.date || ""}</p>
                        ${item.director ? `<p class="meta-info"><em>${item.director}</em></p>` : ""}
                        <a href="${link}" ${target} class="${buttonClass}">${buttonText}</a>
                    </div>
                </div>
            `;
            container.appendChild(card);
        });

        if (filtered.length === 0) {
            container.innerHTML = "<p class='no-results'>Niets gevonden...</p>";
        }
    }

    if (searchInput) {
        searchInput.addEventListener('input', (e) => render(e.target.value));
    }

    render();
});
</script>

<script>
  fetch('nav.html').then(res => res.text()).then(data => {
    document.getElementById('main-nav').innerHTML = data;
  });
</script>

</body>
</html>
