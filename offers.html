<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Offers voor Sesjat</title> <link rel="stylesheet" href="css/style.css">
</head>
<body>
  
<header id="main-header">
  <nav id="main-nav">
    </nav>
</header>

<header class="sesjat-header">
  <p class="glyph">ìÅ∫</p>
  <h1>Offers voor Sesjat</h1>
  <p class="subtitle">Maandelijks een literair werk <br>
Een offer voor de godin van het schrift</p>
</header>

<div class="filter-section">
  <input type="text" id="searchInput" class="search-bar" placeholder="Zoek in het archief...">
</div>

<main class="grid" id="main-container">
  </main>

<script src="data/stories.js"></script>

<script>
window.addEventListener('DOMContentLoaded', () => {
    const container = document.getElementById("main-container");
    const searchInput = document.getElementById("searchInput");

    // 1. Bepaal de lijst op basis van de paginatitel
    let currentList = [];
    const pageTitle = document.title;
    
    if (pageTitle.includes("Offers")) {
        currentList = stories;
    } else if (pageTitle.includes("Archief")) {
        currentList = archiveStories;
    } else if (pageTitle.includes("Reviews")) {
        currentList = reviewStories;
    }

    // 2. De Render functie
    function render(filter = "") {
        container.innerHTML = "";
        const searchTerm = filter.toLowerCase();

        // Filter de lijst
        const filtered = currentList.filter(item => {
            return item.title.toLowerCase().includes(searchTerm) || 
                   (item.year && item.year.includes(searchTerm)) ||
                   (item.director && item.director.toLowerCase().includes(searchTerm)) ||
                   (item.date && item.date.toLowerCase().includes(searchTerm));
        });

        // Toon de kaartjes (Nieuwste eerst)
        filtered.slice().reverse().forEach(item => {
            const card = document.createElement("article");
            card.className = "card";
            
            // Logica voor knoppen en links
            const isExternal = item.link ? true : false;
            const link = isExternal ? item.link : `story.html?id=${item.id}`;
            const target = isExternal ? 'target="_blank" rel="noopener noreferrer"' : '';
            const buttonClass = isExternal ? 'read-link letterboxd-link' : 'read-link';
            const buttonText = isExternal ? 'LEES OP LETTERBOXD ‚Üó' : 'LEES';

            card.innerHTML = `
                <div class="card-content">
                    <img src="${item.image}" alt="${item.title}" class="card-image">
                    <div class="card-text">
                        <h2>${item.title}</h2>
                        <p class="meta">${item.year || item.date || ""}</p>
                        ${item.director ? `<p class="meta-info"><em>${item.director}</em></p>` : ""}
                        <a href="${link}" ${target} class="death-link ${buttonClass}">${buttonText}</a>
                    </div>
                </div>
            `;
            container.appendChild(card);
        });

        // Lege status
        if (filtered.length === 0) {
            container.innerHTML = "<p class='no-results'>Niets gevonden...</p>";
        }
    }

    // 3. Event Listeners
    if (searchInput) {
        searchInput.addEventListener('input', (e) => render(e.target.value));
    }

    render(); // Start de eerste weergave
});
</script>

<script>
  // Menu ophalen
  fetch('nav.html').then(res => res.text()).then(data => {
    document.getElementById('main-nav').innerHTML = data;
  });
</script>

</body>
</html>
